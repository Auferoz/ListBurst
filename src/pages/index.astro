---
import Layout from "../layouts/Layout.astro";
import CardDashboard from "../components/Globals/CardDashboard.astro";
import IconDeviceTv from "../components/Icons/IconDeviceTv.astro";
import IconMovie from "../components/Icons/IconMovie.astro";
import IconGamepad from "../components/Icons/IconGamepad.astro";

import moviesCache from '../data/cache/movies.json';
import seriesCache from '../data/cache/series.json';
import { ListGames } from '../data/gamesDB';

// Stats reales desde los datos
const totalSeries = seriesCache.series.length;
const totalMovies = moviesCache.movies.length;
const totalGames = ListGames.length;
const totalHours = ListGames.reduce((sum, g) => sum + (g.horasTotal || 0), 0);
const totalAchievements = ListGames.reduce((sum, g) => sum + (g.logros_obt || 0), 0);

const date = new Date();
const formatted =
	String(date.getDate()).padStart(2, '0') +
	String(date.getMonth() + 1).padStart(2, '0') +
	date.getFullYear() +
	'.' +
	String(date.getHours()).padStart(2, '0') +
	String(date.getMinutes()).padStart(2, '0');
---

<Layout>
	<main class="max-w-7xl mx-auto p-4 space-y-6">
		<!-- Header -->
		<header class="flex items-center justify-between">
			<h1 class="text-3xl font-bold tracking-tight">Dashboard</h1>
			<span class="text-xs text-gray-400">v0.0.{formatted}</span>
		</header>

		<!-- Cards -->
		<section class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4">
			<CardDashboard text="Series" number={totalSeries} color="sky">
				<IconDeviceTv width={24} height={24} />
			</CardDashboard>
			<CardDashboard text="Movies" number={totalMovies} color="sky">
				<IconMovie width={24} height={24} />
			</CardDashboard>
			<CardDashboard text="Games" number={totalGames} color="green">
				<IconGamepad width={24} height={24} />
			</CardDashboard>
			<CardDashboard text="Hours" number={totalHours} color="zinc">
				<IconGamepad width={24} height={24} />
			</CardDashboard>
			<CardDashboard text="Achievements" number={totalAchievements} color="amber">
				<IconGamepad width={24} height={24} />
			</CardDashboard>
		</section>

		<span class="text-xs text-gray-400">{date}</span>
	</main>
</Layout>
